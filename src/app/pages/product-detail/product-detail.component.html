<div class="product-detail-container">
	@if (ecommerce_item && item_info) {
		<div class="product-card">
			<div class="product-main-image">
				<img [src]="mainImageId | image" alt="{{ item_info.item.name }}">
			</div>
			<div class="product-info">
				<h1 class="product-name">{{ item_info.item.name }}</h1>
				<p class="product-category">{{ item_info.category?.name || ecommerce_item.category_name || 'N/A' }}</p>
				<p class="product-description">{{ item_info.item.description || 'No description available.' }}</p>
				<p class="product-price">{{ ecommerce_item.price | currency }}</p>

				<button class="btn btn-primary add-to-cart-button" (click)="openSizeModal(ecommerce_item.id)">
					AÃ±adir al carrito
				</button>
			</div>
		</div>
		@if (additionalImageIds && additionalImageIds.length > 0) {
			<div class="row mt-3 justify-content-center">
				@for(imageId of additionalImageIds; track imageId) {
					<div class="col-2">
						<img [src]="imageId | image" class="img-fluid thumbnail" [class.selected]="imageId === mainImageId" (click)="setMainImage(imageId)" alt="Product Thumbnail">
					</div>
				}
			</div>
		}
	} @else {
		<div class="text-center">
			<p>Cargando detalles del producto...</p>
		</div>
	}

	<!-- Size Selection Modal -->
	@if (showSizeModal) {
		<div class="modal-backdrop" (click)="closeSizeModal()"></div>
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Seleccionar Tallas</h5>
					<button type="button" class="btn-close" (click)="closeSizeModal()"></button>
				</div>
				<div class="modal-body">
					@if (availableSizes.length > 0) {
						<div class="size-inputs">
							@for (size of availableSizes; track size) {
								<div class="size-input-row">
									<label class="size-label">{{ size }}</label>
									<input
										type="number"
										class="form-control size-input"
										[(ngModel)]="sizeQuantities[size]"
										min="0"
										placeholder="0"
									/>
								</div>
							}
						</div>
					}
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" (click)="closeSizeModal()">Cancelar</button>
					<button type="button" class="btn btn-primary" (click)="confirmAddToCart()">Agregar al carrito</button>
				</div>
			</div>
		</div>
	}
</div>
