<div class="container mt-5">
  <h2 class="app-page-title"> Listado de Órdenes
    <a routerLink="/import-order" class="btn btn-info" style="float: right; margin-left: 10px;">Importar Orden</a>
  </h2>

  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Buscar órdenes..."
      [(ngModel)]="searchTerm"
      (input)="onSearch()">
  </div>

  @if (order_list.length === 0) {
    <div class="alert alert-info">
      No se encontraron órdenes.
    </div>
  }
  @if (order_list.length > 0) {
    <div class="card bg-white p-3">
      <table class="table table-discrete-striped">
        <thead>
          <tr>
            <th>#</th>
            <th>Número de Orden</th>
            <th>Fecha</th>
            <th>Estado</th>
            <th>Notas</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (order of order_list; track order.id) {
            <tr>
              <th scope="row">{{ order.id }}</th>
              <td>{{ order.order_number || 'N/A' }}</td>
              <td>{{ order.order_date | shortDate }}</td>
              <td>
                <span class="badge" [ngClass]="getStatusBadgeClass(order.status)">
                  {{ order.status }}
                </span>
              </td>
              <td>{{ order.notes || '-' }}</td>
              <td class="text-end">
                <a class="btn btn-primary btn-sm" [routerLink]="['/view-order', order.id]">Ver/Editar</a>
                @if (order.status !== 'COMPLETED' && order.status !== 'CANCELLED') {
                  <button class="btn btn-success btn-sm ms-2" (click)="markAsReceived(order)">Marcar como recibida</button>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
