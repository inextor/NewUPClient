<div class="container mt-5">
	<h2 class="app-page-title">Carrito de Compras</h2>

	<div class="card bg-white p-3">
		<div *ngIf="is_loading" class="text-center py-5">
			<div class="spinner-border text-primary" role="status">
				<span class="visually-hidden">Cargando...</span>
			</div>
		</div>

		<div *ngIf="!is_loading && cart_items.length === 0" class="text-center py-5">
			<p class="text-muted">Tu carrito está vacío</p>
		</div>

		<div *ngIf="!is_loading && cart_items.length > 0">
			<div class="table-responsive">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Producto</th>
							<th>Imagen</th>
							<th>Talla</th>
							<th>Cantidad</th>
							<th>Precio</th>
							<th>Subtotal</th>
							<th>Acciones</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let item of cart_items">
							<td>{{ item.ecommerce_item?.name || 'N/A' }}</td>
							<td>
								<img
									*ngIf="item.item_info?.item?.image_id"
									[src]="item.item_info.item.image_id | image"
									alt="{{ item.ecommerce_item?.name }}"
									style="width: 60px; height: 60px; object-fit: cover;"
								>
								<span *ngIf="!item.item_info?.item?.image_id" class="text-muted">Sin imagen</span>
							</td>
							<td>{{ item.size === 'unico' ? 'Único' : item.size }}</td>
							<td>{{ item.qty }}</td>
							<td>${{ item.ecommerce_item?.price || 0 }}</td>
							<td>${{ (item.ecommerce_item?.price || 0) * item.qty }}</td>
							<td>
								<button
									class="btn btn-sm btn-danger"
									(click)="removeFromCart(item.id)"
								>
									Eliminar
								</button>
							</td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<td colspan="5" class="text-end"><strong>Total:</strong></td>
							<td colspan="2"><strong>${{ getTotalPrice() }}</strong></td>
						</tr>
					</tfoot>
				</table>
			</div>

			<div class="mt-3">
				<button class="btn btn-primary">
					Proceder al Checkout
				</button>
			</div>
		</div>
	</div>
</div>
